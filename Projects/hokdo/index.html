<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>项目-销售协作平台 | JJBlog</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="前端、前端教程、小程序、个人博客、张晶晶博客">
    
    <link rel="preload" href="/Blog/assets/css/0.styles.d75286d0.css" as="style"><link rel="preload" href="/Blog/assets/js/app.05fbaaaf.js" as="script"><link rel="preload" href="/Blog/assets/js/2.733019b2.js" as="script"><link rel="preload" href="/Blog/assets/js/26.1d6b4bd9.js" as="script"><link rel="prefetch" href="/Blog/assets/js/10.1c5858b8.js"><link rel="prefetch" href="/Blog/assets/js/11.420206ab.js"><link rel="prefetch" href="/Blog/assets/js/12.a3bf6056.js"><link rel="prefetch" href="/Blog/assets/js/13.5eef12c0.js"><link rel="prefetch" href="/Blog/assets/js/14.7258a101.js"><link rel="prefetch" href="/Blog/assets/js/15.67377551.js"><link rel="prefetch" href="/Blog/assets/js/16.71e5bca4.js"><link rel="prefetch" href="/Blog/assets/js/17.f50924dd.js"><link rel="prefetch" href="/Blog/assets/js/18.a322b80b.js"><link rel="prefetch" href="/Blog/assets/js/19.fe304b8b.js"><link rel="prefetch" href="/Blog/assets/js/20.cabf7c8f.js"><link rel="prefetch" href="/Blog/assets/js/21.65ef7b2a.js"><link rel="prefetch" href="/Blog/assets/js/22.3d5b2a52.js"><link rel="prefetch" href="/Blog/assets/js/23.df34116e.js"><link rel="prefetch" href="/Blog/assets/js/24.553098af.js"><link rel="prefetch" href="/Blog/assets/js/25.3fd7cb0b.js"><link rel="prefetch" href="/Blog/assets/js/27.d0638a89.js"><link rel="prefetch" href="/Blog/assets/js/28.9a1d0826.js"><link rel="prefetch" href="/Blog/assets/js/29.956607b5.js"><link rel="prefetch" href="/Blog/assets/js/3.96557567.js"><link rel="prefetch" href="/Blog/assets/js/30.fde4c090.js"><link rel="prefetch" href="/Blog/assets/js/31.54a22f0c.js"><link rel="prefetch" href="/Blog/assets/js/32.2c3a28dc.js"><link rel="prefetch" href="/Blog/assets/js/33.73f4bbc5.js"><link rel="prefetch" href="/Blog/assets/js/34.186ec671.js"><link rel="prefetch" href="/Blog/assets/js/35.078c8411.js"><link rel="prefetch" href="/Blog/assets/js/36.3afaaebf.js"><link rel="prefetch" href="/Blog/assets/js/37.a3f916b3.js"><link rel="prefetch" href="/Blog/assets/js/4.d12742be.js"><link rel="prefetch" href="/Blog/assets/js/5.216cae74.js"><link rel="prefetch" href="/Blog/assets/js/6.2d0a63f8.js"><link rel="prefetch" href="/Blog/assets/js/7.69e75d2d.js"><link rel="prefetch" href="/Blog/assets/js/8.d35a637b.js"><link rel="prefetch" href="/Blog/assets/js/9.2fe8d97f.js">
    <link rel="stylesheet" href="/Blog/assets/css/0.styles.d75286d0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Blog/" class="home-link router-link-active"><!----> <span class="site-name">JJBlog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Blog/Resume/myResume/" class="nav-link">
  Resume
</a></div><div class="nav-item"><a href="/Blog/Blog/" class="nav-link">
  Blogs
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Menu" class="dropdown-title"><span class="title">Others</span> <span class="arrow down"></span></button> <button type="button" aria-label="Menu" class="mobile-dropdown-title"><span class="title">Others</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Blog/other/contact/" class="nav-link">
  与我联系
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Xiaojing-511?tab=repositories" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Blog/Resume/myResume/" class="nav-link">
  Resume
</a></div><div class="nav-item"><a href="/Blog/Blog/" class="nav-link">
  Blogs
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Menu" class="dropdown-title"><span class="title">Others</span> <span class="arrow down"></span></button> <button type="button" aria-label="Menu" class="mobile-dropdown-title"><span class="title">Others</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Blog/other/contact/" class="nav-link">
  与我联系
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Xiaojing-511?tab=repositories" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/Blog/Resume/myResume/" class="sidebar-heading clickable"><span>Resume</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/Blog/Projects/hokdo/" aria-current="page" class="sidebar-heading clickable router-link-exact-active router-link-active open active"><span>Projects</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/Projects/hokdo/" aria-current="page" class="active sidebar-link">hokdo-销售协作平台</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog/Projects/hokdo/#项目-销售协作平台" class="sidebar-link">项目-销售协作平台</a></li><li class="sidebar-sub-header"><a href="/Blog/Projects/hokdo/#模块拆分-导航模块" class="sidebar-link">模块拆分 - 导航模块</a></li><li class="sidebar-sub-header"><a href="/Blog/Projects/hokdo/#模块拆分-对话模块" class="sidebar-link">模块拆分 - 对话模块</a></li><li class="sidebar-sub-header"><a href="/Blog/Projects/hokdo/#模块拆分-工单模块" class="sidebar-link">模块拆分 - 工单模块</a></li><li class="sidebar-sub-header"><a href="/Blog/Projects/hokdo/#模块拆分-对话机器人模块" class="sidebar-link">模块拆分 - 对话机器人模块</a></li></ul></li><li><a href="/Blog/Projects/hokdosdk/" class="sidebar-link">hokdo-sdk</a></li><li><a href="/Blog/Projects/campus/" class="sidebar-link">大学生校园交流网站</a></li><li><a href="/Blog/Projects/kanban/" class="sidebar-link">看板外化</a></li><li><a href="/Blog/Projects/floatball/" class="sidebar-link">悬浮球</a></li><li><a href="/Blog/Projects/promotion/" class="sidebar-link">优惠平台</a></li><li><a href="/Blog/Projects/mobileMedia/" class="sidebar-link">移动多媒体app</a></li><li><a href="/Blog/Projects/qiuzhidi/" class="sidebar-link">求职帝小程序</a></li><li><a href="/Blog/Projects/todo/" class="sidebar-link">每日便签</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/Blog/Blog/" class="sidebar-heading clickable"><span>Blogs</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/Blog/Notes/note1/" class="sidebar-heading clickable"><span>Notes</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="项目-销售协作平台"><a href="#项目-销售协作平台" class="header-anchor">#</a> 项目-销售协作平台</h2> <blockquote><p>2022-7-01 11:34:09
<br>分类专栏：react sass</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>下一代的销售协作工具
更快的协作销售、更多的客户上下文，实现前所未有的收入增长和客户洞察
</code></pre></div><h3 id="页面展示"><a href="#页面展示" class="header-anchor">#</a> 页面展示</h3> <p><img src="https://img-blog.csdnimg.cn/bfbe325d448d462eab636f40a705c37e.png#pic_center" alt="在这里插入图片描述"></p> <h2 id="模块拆分-导航模块"><a href="#模块拆分-导航模块" class="header-anchor">#</a> 模块拆分 - 导航模块</h2> <p><strong>模块功能描述</strong></p> <ul><li>导航模块主要分为首页（数据总览）及其他模块导航部分，对应组件 <code>&lt;NavSider /&gt;</code></li> <li>可通过根路径或点击左上角企业 logo 进入首页</li> <li>除首页外其他均展示为二级导航栏，且可通过点击 icon 展开收起竖形二级导航</li> <li>二级导航展开收起状态存储在本地，命名为 “NAV_FOLD”</li> <li>二级导航内选中的模块存储在本地，命名为 “NAV_SELECTED_HISTORY”</li></ul> <p><strong>功能点解析</strong></p> <ul><li>增加一级/二级导航</li> <li>在 router.jsx -&gt; outterRoutes 新增导航信息对象，二级导航则配置 subRoutes</li> <li>注意在导航组件 <code>&lt;NavSider /&gt;</code> 及 <code>&lt;SubSiderApp/&gt;</code> 中都要对 genSelectedKey 进行补充（配置路径对应关系）</li> <li>注意权限导致的导航隐藏情况</li> <li>若二级导航均无权限则对应的一级导航也隐藏</li> <li>权限可分为：是否为管理员以及自定义角色下配置的权限（user.permission_list）</li></ul> <h2 id="模块拆分-对话模块"><a href="#模块拆分-对话模块" class="header-anchor">#</a> 模块拆分 - 对话模块</h2> <p><strong>模块功能描述</strong></p> <ul><li>对话模块部分页面主要功能是与 c2 进行沟通和对 c2 的信息进行存储和展示（右侧联系人详情）</li> <li>群聊对话借助第三方环信能力进行消息实时接收</li></ul> <p><strong>功能点解析</strong></p> <ul><li>该模块导航图标增加未读消息红点提醒
<ul><li>初始进入页面时获取未读数：使用环信获取，并手动筛出我负责的进行未读展示<code>（chat.js - getUnReadCount()）</code></li> <li>对话期间红点提醒的条件：我负责的对话有新消息（除对话关闭提醒类消息）具体<code>（chat.js - updateLastMsgByOther()）</code></li> <li>清空环信记录的某群聊对话未读数： 发送一条 chatType: 'groupChat' 的消息（<code>chat.js - readGroupMsg()）</code></li></ul></li> <li>我负责的对话及负责人配置
<ul><li>未读红点及浏览器通知仅提醒我负责的对话（即负责人是自己）</li> <li>可在设置 -对话中设置对话负责人待选项</li></ul></li> <li>新对话/重新活跃对话加群、消息实时接收
<ul><li>新对话/重新活跃使用监听 onCustomMessage 函数的方式<code>（shared.js - fetchProfile() - EaseMobManager.conn.listen）</code>，之后调用环信加群 api</li> <li>新消息实时接收利用环信能力：监听 onTextMessage 函数<code>（shared.js - fetchProfile() - EaseMobManager.conn.listen）</code></li> <li>我负责的对话收到新消息同时会进行两种方式的通知
<ul><li>站内 semi 组件<code>&lt;Notification/&gt;</code>通知 （需不在新消息对话的对话页面）</li> <li>浏览器通知</li> <li><code>notifycation.js - noticeChatNewMessage()</code></li></ul></li></ul></li> <li>消息撤回
<ul><li>仅可撤回自己发送的消息（技术上属于假撤回，数据库未删除该条消息记录，仅使用字段标识是否被删除）</li></ul></li> <li>消息列表
<ul><li>列表拉取接口：<code>api/chat/list-message-history</code></li></ul></li> <li>消息类型（按角色分）：机器人消息/ c1 发送的内容/ c2 发送的内容
<ul><li>区分：通过列表接口数据下的消息信息 msg.cid 前缀区分消息类型
[图片]</li> <li>机器人消息：包括系统时间消息、对话关闭系统消息及机器人消息（类型可由 msg.type 区分）</li></ul></li></ul> <h2 id="模块拆分-工单模块"><a href="#模块拆分-工单模块" class="header-anchor">#</a> 模块拆分 - 工单模块</h2> <p><img src="https://img-blog.csdnimg.cn/cbd80f9c417447359307bd5c72a33891.png" alt="在这里插入图片描述"> <img src="https://img-blog.csdnimg.cn/044fbcff1bc34d5ab5f6354ed5991944.png" alt="在这里插入图片描述"> <strong>模块功能描述</strong></p> <ul><li>工单模块主要是对由 c1 或 c2 提出的工单进行展示和管理</li> <li>页面左侧部分为按试图分类的列表目录，公共视图全员可见、仅管理员可编辑，个人视图仅个人可查看和编辑</li> <li>页面右侧部分为对应视图下筛选出来的列表，筛选条件通过编辑视图修改</li></ul> <p><strong>功能点解析</strong></p> <ul><li>新增视图：三点设置 - 添加视图，编辑视图名称及筛选条件（或且逻辑）</li> <li>视图列表调整顺序：顺序可通过三点设置 - 编辑顺序拖拽调整</li> <li>工单视图信息的存储：工单视图信息及其对应的筛选条件由接口<code>/api/console-config/create-config</code>存储，公共视图需增加字段<code>is_global: true</code></li> <li>公共/个人分为两个字段存储：变量名分别为<code>TICKET_LIST_VIEW_TYPE_ME TICKET_LIST_VIEW_TYPE_COMMON</code></li> <li>存储结构（公共视图为例，个人视图仅视图类型字段值不同）</li></ul> <div class="language- extra-class"><pre class="language-text"><code>
id: &quot;406567002307&quot;
label: &quot;测试 test&quot;
viewType: &quot;common&quot;
filter: [{condition: [{field: &quot;ticket_status&quot;, relation: &quot;include&quot;, value: &quot;0&quot;, type: &quot;SINGLE_SELECT&quot;},…]},…]
0: {condition: [{field: &quot;ticket_status&quot;, relation: &quot;include&quot;, value: &quot;0&quot;, type: &quot;SINGLE_SELECT&quot;},…]}
condition: [{field: &quot;ticket_status&quot;, relation: &quot;include&quot;, value: &quot;0&quot;, type: &quot;SINGLE_SELECT&quot;},…]
0: {field: &quot;ticket_status&quot;, relation: &quot;include&quot;, value: &quot;0&quot;, type: &quot;SINGLE_SELECT&quot;}
field: &quot;ticket_status&quot;
relation: &quot;include&quot;
type: &quot;SINGLE_SELECT&quot;
value: &quot;0&quot;
1: {field: &quot;ticket_priority&quot;, relation: &quot;include&quot;, value: 1, type: &quot;SINGLE_SELECT&quot;}
1: {condition: [{field: &quot;ticket_status&quot;, relation: &quot;include&quot;, value: &quot;5&quot;, type: &quot;SINGLE_SELECT&quot;}]}

</code></pre></div><p><strong>字段解析</strong></p> <ul><li>id: 唯一标识</li> <li>label: 视图名称</li> <li>viewType: 视图类型（公共 common /个人 me）</li> <li>filter: 筛选条件（或且逻辑，filter 数组项间为 或者关系，数据项内的 condition 数组项间为并且关系）</li> <li>工单视图信息的获取：由接口<code>/api/console-config/info</code>获取，同样公共视图需增加字段<code>is_global: true</code></li> <li>视图总数的获取：通过传入对应视图的筛选条件调用列表接口获得 <code>/api/ticket/list</code></li> <li>函数位置：<code>ticket.js -&gt; getViewTotal()</code></li> <li>视图总数的获取会根据视图数的递增而逐渐耗费时间，且一些操作执行后都需要触发总数的更新，eg: 新建工单、通过点开工单详情修改工单信息（状态等影响筛选改变的字段）、编辑删除工单。后续待优化，理想通过接口直接存储获取视图的信息。</li> <li>右侧工单列表区域需注意</li> <li>快捷筛选：仅支持实时筛选工单，不会将增加的筛选条件合进视图的筛选项中，即不会改变视图总数（视图总数仅由编辑视图页面的筛选条件为准）</li> <li>表头快捷排序：处理时间暂不支持排序，处理时间由前端通过字段<code>record.ticket_create_time,record.ticket_end_time</code>自行计算（具体计算规则见<code>utils -&gt; time.jsx -&gt; generateDurationTimeContentText()</code> ），后端暂时无法排序</li> <li>工单详情抽屉：通过点击工单标题弹出</li></ul> <h2 id="模块拆分-对话机器人模块"><a href="#模块拆分-对话机器人模块" class="header-anchor">#</a> 模块拆分 - 对话机器人模块</h2> <p><img src="https://img-blog.csdnimg.cn/966808173b494713915712a2fc65a0f7.png" alt="在这里插入图片描述"> <img src="https://img-blog.csdnimg.cn/8a5da506acf541a4848786b4377e2404.png" alt="在这里插入图片描述"> <strong>模块功能描述</strong></p> <ul><li>快速配置与客户的对话旅程，提升沟通效率</li></ul> <p><strong>功能点解析</strong></p> <ul><li><p>可通过设置优先级来调整机器人触发顺序</p></li> <li><p>创建/编辑机器人（playbook）</p></li> <li><p>通过节点形式存储信息，一个卡片抽象为一个节点</p></li> <li><p>节点分类：机器人配置节点（<code>type: &quot;robotConfig&quot;</code>）、消息节点（<code>type: &quot;messageNode&quot;</code>）、问题节点（<code>type: &quot;questionNode&quot;</code>，可将回答存储到自定义字段）以及结束流程节点（<code>type: &quot;endNode&quot;</code>）</p></li> <li><p>数据存储分为两部分：机器人配置信息及四种类型节点信息 - 机器人配置信息：数据获取接口 <code>/api/chat/chatbot/detail</code> 位置：<code>data.detail.conditions</code> <img src="https://img-blog.csdnimg.cn/30756061124145d5a6532f5df4c37c9b.png#pic_center" alt="在这里插入图片描述"></p> <ul><li>节点信息：数据获取接口 <code>/api/chat/chatbot/node-list</code></li> <li>节点数据结构（通过字段 next_node_id 来连接下一节点）
<ul><li>机器人配置节点：</li></ul> <div class="language- extra-class"><pre class="language-text"><code>{
    next_node_id: &quot;27c03601-9e4d-48fd-b689-b3eeaf7325e2&quot;
    node_id: &quot;320fe32a-0761-4a85-a3a1-0299fd083cf8&quot;
    position: {x: 0, y: 325}
    type: &quot;robotConfig&quot;
}
</code></pre></div><ul><li>消息节点
<ul><li>default_option 字段表示兜底节点，options 表示选项 (兜底节点为文字输入框右侧支出来的节点)</li> <li>上述两个字段下的 id 均为拼接 id，拼接规则：当前节点 id + '_' + 表示兜底/选项的节点 id <img src="https://img-blog.csdnimg.cn/57ea50a00c924bd19c87cf85bc9729e8.png#pic_center" alt="在这里插入图片描述"></li></ul></li> <li>问题节点
<ul><li>default_option 字段表示兜底节点
<img src="https://img-blog.csdnimg.cn/2b1ca8d5c9c24264887e224bf9ecc446.png#pic_center" alt="在这里插入图片描述"></li></ul></li> <li>结束节点</li></ul></li></ul></li> <li><p>数据格式化</p> <ul><li>后端返回数据 -&gt; 前端展示需要的数据格式
<ul><li>函数位置：<code>pages/Playbook/CreateRobot-&gt;analyseCurRobot()</code></li></ul></li> <li>前端数据 -&gt; 后端存储需要的格式
<ul><li>函数位置：<code>pages/Playbook/CreateRobot-&gt;formatDataToSubmit()</code></li></ul></li></ul></li> <li><p>需注意：通过模版创建机器人后，提交前需统一更换 id</p> <ul><li>函数位置：<code>pages/Playbook/CreateRobot-&gt;replaceNodeId()</code></li></ul></li></ul> <div class="language- extra-class"><pre class="language-text"><code>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Blog/Resume/myResume/" class="prev">
        个人简历
      </a></span> <span class="next"><a href="/Blog/Projects/hokdosdk/">
        hokdo-sdk
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Blog/assets/js/app.05fbaaaf.js" defer></script><script src="/Blog/assets/js/2.733019b2.js" defer></script><script src="/Blog/assets/js/26.1d6b4bd9.js" defer></script>
  </body>
</html>
